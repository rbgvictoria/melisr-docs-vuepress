<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Specify IPT integration – Part 2 | MELISR documentation</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/melisr-docs-vuepress/assets/css/0.styles.4e056352.css" as="style"><link rel="preload" href="/melisr-docs-vuepress/assets/js/app.ed396d9f.js" as="script"><link rel="preload" href="/melisr-docs-vuepress/assets/js/3.08a0837d.js" as="script"><link rel="preload" href="/melisr-docs-vuepress/assets/js/31.d48320b5.js" as="script"><link rel="prefetch" href="/melisr-docs-vuepress/assets/js/10.5ae15643.js"><link rel="prefetch" href="/melisr-docs-vuepress/assets/js/11.1adacd3d.js"><link rel="prefetch" href="/melisr-docs-vuepress/assets/js/12.587868a1.js"><link rel="prefetch" href="/melisr-docs-vuepress/assets/js/13.ac7bcf09.js"><link rel="prefetch" href="/melisr-docs-vuepress/assets/js/14.02675d19.js"><link rel="prefetch" href="/melisr-docs-vuepress/assets/js/15.40e7bd7e.js"><link rel="prefetch" href="/melisr-docs-vuepress/assets/js/16.07b41535.js"><link rel="prefetch" href="/melisr-docs-vuepress/assets/js/17.23e92267.js"><link rel="prefetch" href="/melisr-docs-vuepress/assets/js/18.42e0d9d6.js"><link rel="prefetch" href="/melisr-docs-vuepress/assets/js/19.5dd49a63.js"><link rel="prefetch" href="/melisr-docs-vuepress/assets/js/2.c6acca67.js"><link rel="prefetch" href="/melisr-docs-vuepress/assets/js/20.22f6b089.js"><link rel="prefetch" href="/melisr-docs-vuepress/assets/js/21.9881b452.js"><link rel="prefetch" href="/melisr-docs-vuepress/assets/js/22.503b342f.js"><link rel="prefetch" href="/melisr-docs-vuepress/assets/js/23.fae0bb15.js"><link rel="prefetch" href="/melisr-docs-vuepress/assets/js/24.3b18ed35.js"><link rel="prefetch" href="/melisr-docs-vuepress/assets/js/25.1dd8e852.js"><link rel="prefetch" href="/melisr-docs-vuepress/assets/js/26.e6e89cf6.js"><link rel="prefetch" href="/melisr-docs-vuepress/assets/js/27.12b6fdb0.js"><link rel="prefetch" href="/melisr-docs-vuepress/assets/js/28.8788af6a.js"><link rel="prefetch" href="/melisr-docs-vuepress/assets/js/29.8c4a54b9.js"><link rel="prefetch" href="/melisr-docs-vuepress/assets/js/30.8e54ddc7.js"><link rel="prefetch" href="/melisr-docs-vuepress/assets/js/32.aef22f61.js"><link rel="prefetch" href="/melisr-docs-vuepress/assets/js/33.43d76f8d.js"><link rel="prefetch" href="/melisr-docs-vuepress/assets/js/34.c625cab3.js"><link rel="prefetch" href="/melisr-docs-vuepress/assets/js/35.8632b307.js"><link rel="prefetch" href="/melisr-docs-vuepress/assets/js/36.1d0b34c3.js"><link rel="prefetch" href="/melisr-docs-vuepress/assets/js/37.6faa5075.js"><link rel="prefetch" href="/melisr-docs-vuepress/assets/js/38.7311e6ab.js"><link rel="prefetch" href="/melisr-docs-vuepress/assets/js/4.b5565ff5.js"><link rel="prefetch" href="/melisr-docs-vuepress/assets/js/5.3e537086.js"><link rel="prefetch" href="/melisr-docs-vuepress/assets/js/6.211bd2e1.js"><link rel="prefetch" href="/melisr-docs-vuepress/assets/js/7.56738cb3.js"><link rel="prefetch" href="/melisr-docs-vuepress/assets/js/8.a906b5fb.js"><link rel="prefetch" href="/melisr-docs-vuepress/assets/js/9.f1f1474a.js">
    <link rel="stylesheet" href="/melisr-docs-vuepress/assets/css/0.styles.4e056352.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/melisr-docs-vuepress/" class="home-link router-link-active"><!----> <span class="site-name">MELISR documentation</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/melisr-docs-vuepress/data-entry-manual/" class="nav-link">Data entry manual</a></div><div class="nav-item"><a href="/melisr-docs-vuepress/additional-documents/" class="nav-link router-link-active">Additional documents</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/melisr-docs-vuepress/data-entry-manual/" class="nav-link">Data entry manual</a></div><div class="nav-item"><a href="/melisr-docs-vuepress/additional-documents/" class="nav-link router-link-active">Additional documents</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/melisr-docs-vuepress/additional-documents/melisr-fields-in-avh/" class="sidebar-link">MELISR fields in AVH</a></li><li><a href="/melisr-docs-vuepress/additional-documents/herbarium-interactions/" class="sidebar-link">Herbarium interactions</a></li><li><a href="/melisr-docs-vuepress/additional-documents/business-case/" class="sidebar-link">Business case (2009)</a></li><li><a href="/melisr-docs-vuepress/additional-documents/specify-dwc-mapping/" class="sidebar-link">Specify to Darwin Core mapping</a></li><li><a href="/melisr-docs-vuepress/additional-documents/specify-ipt-integration/" class="sidebar-link">Specify IPT integration</a></li><li><a href="/melisr-docs-vuepress/additional-documents/people-in-specify/" class="sidebar-link">People and people identifiers in Specify</a></li><li><a href="/melisr-docs-vuepress/additional-documents/qa-tests/" class="sidebar-link">Quality assurance tests</a></li><li><a href="/melisr-docs-vuepress/additional-documents/specify-ipt-integration-pt2/" class="active sidebar-link">Specify IPT integration – Part 2</a></li></ul> </aside> <main class="page"> <div class="content default"><h1 id="specify-ipt-integration-–-part-2"><a href="#specify-ipt-integration-–-part-2" aria-hidden="true" class="header-anchor">#</a> Specify IPT integration – Part 2</h1> <p>At a meeting of the Specify Collections Consortium Technical Advisory Committee,
some suggestions were made on how to create the higher geography and taxonomy
without using the nested sets. For our IPT this means that we could do without
the auxiliary tables for higher geography and higher taxonomy, which take a long
time to create and the creation of which is hard to synchronise with the
publication of the Darwin Core Archives.</p> <p>So, below is the even more impressive query that we use now. The publication of
Darwin Core Archives with this query has actually become about 20 per cent
faster, but that may be because I have upgraded our IPT to the newest version
and moved it to a network (rather than DMZ) server. The important thing is that
it is not too much slower.</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span>
  co<span class="token punctuation">.</span>CollectionObjectID <span class="token keyword">as</span> id<span class="token punctuation">,</span>

  <span class="token comment">-- occurrenceID</span>
  co<span class="token punctuation">.</span>GUID <span class="token keyword">as</span> occurrenceID<span class="token punctuation">,</span>

  <span class="token comment">/*
  * Record Level Terms
  */</span>

  <span class="token comment">-- type</span>
  <span class="token string">'PhysicalObject'</span> <span class="token keyword">as</span> <span class="token string">&quot;type&quot;</span><span class="token punctuation">,</span>

  <span class="token comment">-- modified</span>
  co<span class="token punctuation">.</span>TimestampModified <span class="token keyword">as</span> modified<span class="token punctuation">,</span>

  <span class="token comment">-- license</span>
  <span class="token string">'https://creativecommons.org/licenses/by/4.0/legalcode'</span> <span class="token keyword">AS</span> license<span class="token punctuation">,</span>

  <span class="token comment">-- rightsHolder</span>
  <span class="token string">'Royal Botanic Gardens Board'</span> <span class="token keyword">AS</span> rightsHolder<span class="token punctuation">,</span>

  <span class="token comment">-- institutionCode</span>
  <span class="token string">'MEL'</span> <span class="token keyword">as</span> institutionCode<span class="token punctuation">,</span>

  <span class="token comment">-- collectionCode</span>
  <span class="token string">'MEL'</span> <span class="token keyword">as</span> collectionCode<span class="token punctuation">,</span>

  <span class="token comment">-- basisOfRecord</span>
  <span class="token string">'PreservedSpecimen'</span> <span class="token keyword">as</span> basisOfRecord<span class="token punctuation">,</span>

  <span class="token comment">-- informationWithheld</span>
  coa<span class="token punctuation">.</span>Text26 <span class="token keyword">as</span> informationWithheld<span class="token punctuation">,</span>

  <span class="token comment">-- dataGeneralizations</span>
  coa<span class="token punctuation">.</span>Text25 <span class="token keyword">as</span> dataGeneralizations<span class="token punctuation">,</span>

  <span class="token comment">/*
  *  Occurrence
  */</span>

  <span class="token comment">-- catalogNumber</span>
  concat<span class="token punctuation">(</span><span class="token string">'MEL '</span><span class="token punctuation">,</span> co<span class="token punctuation">.</span>CatalogNumber<span class="token punctuation">)</span> <span class="token keyword">as</span> catalogNumber<span class="token punctuation">,</span>

  <span class="token comment">-- occurrenceRemarks</span>
  occurrenceRemarks<span class="token punctuation">(</span>ce<span class="token punctuation">.</span>VerbatimLocality<span class="token punctuation">,</span> co<span class="token punctuation">.</span>Remarks<span class="token punctuation">)</span> <span class="token keyword">as</span> occurrenceRemarks<span class="token punctuation">,</span>

  <span class="token comment">-- recordNumber</span>
  ce<span class="token punctuation">.</span>StationFieldNumber <span class="token keyword">as</span> recordNumber<span class="token punctuation">,</span>

  <span class="token comment">-- recordedBy</span>
  collectorstring<span class="token punctuation">(</span>ce<span class="token punctuation">.</span>CollectingEventID<span class="token punctuation">,</span> <span class="token string">' | '</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token keyword">as</span> recordedBy<span class="token punctuation">,</span>

  <span class="token comment">-- recordedByID</span>
  recorded_by_id<span class="token punctuation">(</span>ce<span class="token punctuation">.</span>CollectingEventID<span class="token punctuation">)</span> <span class="token keyword">as</span> recordedByID<span class="token punctuation">,</span>

  <span class="token comment">-- reproductiveCondition</span>
  dwc_reproductive_condition<span class="token punctuation">(</span>co<span class="token punctuation">.</span>CollectionObjectID<span class="token punctuation">)</span> <span class="token keyword">as</span> reproductiveCondition<span class="token punctuation">,</span>

  <span class="token comment">-- establishmentMeans</span>
  dwc_establishment_means<span class="token punctuation">(</span>co<span class="token punctuation">.</span>CollectionObjectID<span class="token punctuation">)</span> <span class="token keyword">as</span> establishmentMeans<span class="token punctuation">,</span>

  <span class="token comment">-- occurrenceStatus</span>
  <span class="token string">'present'</span> <span class="token keyword">as</span> occurrenceStatus<span class="token punctuation">,</span>

  <span class="token comment">-- preparations</span>
  preparations<span class="token punctuation">(</span>co<span class="token punctuation">.</span>CollectionObjectID<span class="token punctuation">)</span> <span class="token keyword">as</span> preparations<span class="token punctuation">,</span>

  <span class="token comment">-- associatedSequences</span>
  seq<span class="token punctuation">.</span>associated_sequences <span class="token keyword">as</span> associatedSequences<span class="token punctuation">,</span>

  <span class="token comment">-- associatedTaxa</span>

  <span class="token comment">/*
  * Organism
  */</span>

  <span class="token comment">-- previousIdentifications</span>
  previous_identifications<span class="token punctuation">(</span>co<span class="token punctuation">.</span>CollectionObjectID<span class="token punctuation">)</span> <span class="token keyword">as</span> previousIdentifications<span class="token punctuation">,</span>

  <span class="token comment">/*
  * Event
  */</span>

  <span class="token comment">-- eventID</span>
  ce<span class="token punctuation">.</span>GUID <span class="token keyword">as</span> eventID<span class="token punctuation">,</span>

  <span class="token comment">-- parentEventID</span>
  ctr<span class="token punctuation">.</span>CollectingTripName <span class="token keyword">as</span> parentEventID<span class="token punctuation">,</span>

  <span class="token comment">-- eventDate</span>
  concat_ws<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> dateWithPrecision<span class="token punctuation">(</span>ce<span class="token punctuation">.</span>StartDate<span class="token punctuation">,</span> ce<span class="token punctuation">.</span>StartDatePrecision<span class="token punctuation">)</span><span class="token punctuation">,</span>
      dateWithPrecision<span class="token punctuation">(</span>ce<span class="token punctuation">.</span>EndDate<span class="token punctuation">,</span> ce<span class="token punctuation">.</span>EndDatePrecision<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">as</span> eventDate<span class="token punctuation">,</span>

  <span class="token comment">-- startDayOfYear</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>ce<span class="token punctuation">.</span>EndDate <span class="token operator">is</span> <span class="token boolean">null</span> <span class="token operator">and</span> ce<span class="token punctuation">.</span>StartDatePrecision<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> dayofyear<span class="token punctuation">(</span>ce<span class="token punctuation">.</span>StartDate<span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token boolean">null</span><span class="token punctuation">)</span> <span class="token keyword">as</span> startDayOfYear<span class="token punctuation">,</span>

  <span class="token comment">-- year</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>ce<span class="token punctuation">.</span>EndDate <span class="token operator">is</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token keyword">year</span><span class="token punctuation">(</span>ce<span class="token punctuation">.</span>StartDate<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token string">&quot;year&quot;</span><span class="token punctuation">,</span>

  <span class="token comment">-- month</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>ce<span class="token punctuation">.</span>EndDate <span class="token operator">is</span> <span class="token boolean">null</span> <span class="token operator">and</span> ce<span class="token punctuation">.</span>StartDatePrecision <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token keyword">month</span><span class="token punctuation">(</span>ce<span class="token punctuation">.</span>StartDate<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token string">&quot;month&quot;</span><span class="token punctuation">,</span>

  <span class="token comment">-- day</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>ce<span class="token punctuation">.</span>EndDate <span class="token operator">is</span> <span class="token boolean">null</span> <span class="token operator">and</span> ce<span class="token punctuation">.</span>StartDatePrecision<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">day</span><span class="token punctuation">(</span>ce<span class="token punctuation">.</span>StartDate<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span>
      <span class="token keyword">as</span> <span class="token string">&quot;day&quot;</span><span class="token punctuation">,</span>

  <span class="token comment">-- verbatimEventDate</span>
  ce<span class="token punctuation">.</span>VerbatimDate <span class="token keyword">as</span> verbatimEventDate<span class="token punctuation">,</span>

  <span class="token comment">-- habitat</span>
  ce<span class="token punctuation">.</span>Remarks <span class="token keyword">as</span> habitat<span class="token punctuation">,</span>

  <span class="token comment">/*
  * Location
  */</span>

  <span class="token comment">-- locationID</span>
  l<span class="token punctuation">.</span>GUID <span class="token keyword">as</span> locationID<span class="token punctuation">,</span>

  <span class="token comment">-- higherGeography</span>
  <span class="token keyword">case</span>
    <span class="token keyword">when</span> g4<span class="token punctuation">.</span>GeographyID <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token operator">AND</span> g4<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Earth'</span> <span class="token keyword">then</span> concat_ws<span class="token punctuation">(</span><span class="token string">' | '</span><span class="token punctuation">,</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>gdi4<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'Continent'</span><span class="token punctuation">,</span> map_continent<span class="token punctuation">(</span>g4<span class="token punctuation">.</span>Name<span class="token punctuation">)</span><span class="token punctuation">,</span> g4<span class="token punctuation">.</span>Name<span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>gdi3<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'Continent'</span><span class="token punctuation">,</span> map_continent<span class="token punctuation">(</span>g3<span class="token punctuation">.</span>Name<span class="token punctuation">)</span><span class="token punctuation">,</span> g3<span class="token punctuation">.</span>Name<span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>gdi2<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'Continent'</span><span class="token punctuation">,</span> map_continent<span class="token punctuation">(</span>g2<span class="token punctuation">.</span>Name<span class="token punctuation">)</span><span class="token punctuation">,</span> g2<span class="token punctuation">.</span>Name<span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>gdi1<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'Continent'</span><span class="token punctuation">,</span> map_continent<span class="token punctuation">(</span>g1<span class="token punctuation">.</span>Name<span class="token punctuation">)</span><span class="token punctuation">,</span> g1<span class="token punctuation">.</span>Name<span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
    <span class="token keyword">when</span> g3<span class="token punctuation">.</span>GeographyID <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token operator">AND</span> g3<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Earth'</span> <span class="token keyword">then</span> concat_ws<span class="token punctuation">(</span><span class="token string">' | '</span><span class="token punctuation">,</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>gdi3<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'Continent'</span><span class="token punctuation">,</span> map_continent<span class="token punctuation">(</span>g3<span class="token punctuation">.</span>Name<span class="token punctuation">)</span><span class="token punctuation">,</span> g3<span class="token punctuation">.</span>Name<span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>gdi2<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'Continent'</span><span class="token punctuation">,</span> map_continent<span class="token punctuation">(</span>g2<span class="token punctuation">.</span>Name<span class="token punctuation">)</span><span class="token punctuation">,</span> g2<span class="token punctuation">.</span>Name<span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>gdi1<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'Continent'</span><span class="token punctuation">,</span> map_continent<span class="token punctuation">(</span>g1<span class="token punctuation">.</span>Name<span class="token punctuation">)</span><span class="token punctuation">,</span> g1<span class="token punctuation">.</span>Name<span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
    <span class="token keyword">when</span> g2<span class="token punctuation">.</span>GeographyID <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token operator">AND</span> g2<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Earth'</span> <span class="token keyword">then</span> concat_ws<span class="token punctuation">(</span><span class="token string">' | '</span><span class="token punctuation">,</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>gdi2<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'Continent'</span><span class="token punctuation">,</span> map_continent<span class="token punctuation">(</span>g2<span class="token punctuation">.</span>Name<span class="token punctuation">)</span><span class="token punctuation">,</span> g2<span class="token punctuation">.</span>Name<span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>gdi1<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'Continent'</span><span class="token punctuation">,</span> map_continent<span class="token punctuation">(</span>g1<span class="token punctuation">.</span>Name<span class="token punctuation">)</span><span class="token punctuation">,</span> g1<span class="token punctuation">.</span>Name<span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
    <span class="token keyword">when</span> g1<span class="token punctuation">.</span>GeographyID <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token operator">AND</span> g1<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Earth'</span> <span class="token keyword">then</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>gdi1<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'Continent'</span><span class="token punctuation">,</span> map_continent<span class="token punctuation">(</span>g1<span class="token punctuation">.</span>Name<span class="token punctuation">)</span><span class="token punctuation">,</span> g1<span class="token punctuation">.</span>Name<span class="token punctuation">)</span>
    <span class="token keyword">else</span> <span class="token boolean">null</span>
  <span class="token keyword">end</span> <span class="token keyword">as</span> higherGeography<span class="token punctuation">,</span>

  <span class="token comment">-- waterBody</span>
  ld<span class="token punctuation">.</span>WaterBody <span class="token keyword">as</span> waterBody<span class="token punctuation">,</span>

  <span class="token comment">-- islandGroup</span>
  ld<span class="token punctuation">.</span>IslandGroup <span class="token keyword">as</span> islandGroup<span class="token punctuation">,</span>

  <span class="token comment">-- island</span>
  ld<span class="token punctuation">.</span>Island <span class="token keyword">as</span> island<span class="token punctuation">,</span>

  <span class="token comment">-- continent</span>
  <span class="token keyword">case</span>
    <span class="token keyword">when</span> gdi0<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'Continent'</span> <span class="token keyword">then</span> map_continent<span class="token punctuation">(</span>g0<span class="token punctuation">.</span>Name<span class="token punctuation">)</span>
    <span class="token keyword">when</span> gdi1<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'Continent'</span> <span class="token keyword">then</span> map_continent<span class="token punctuation">(</span>g1<span class="token punctuation">.</span>Name<span class="token punctuation">)</span>
    <span class="token keyword">when</span> gdi2<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'Continent'</span> <span class="token keyword">then</span> map_continent<span class="token punctuation">(</span>g2<span class="token punctuation">.</span>Name<span class="token punctuation">)</span>
    <span class="token keyword">when</span> gdi3<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'Continent'</span> <span class="token keyword">then</span> map_continent<span class="token punctuation">(</span>g3<span class="token punctuation">.</span>Name<span class="token punctuation">)</span>
    <span class="token keyword">when</span> gdi4<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'Continent'</span> <span class="token keyword">then</span> map_continent<span class="token punctuation">(</span>g4<span class="token punctuation">.</span>Name<span class="token punctuation">)</span>
    <span class="token keyword">else</span> <span class="token boolean">null</span>
  <span class="token keyword">end</span> <span class="token keyword">as</span> continent<span class="token punctuation">,</span>

  <span class="token comment">-- country</span>
  <span class="token keyword">case</span>
    <span class="token keyword">when</span> gdi0<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'Country'</span> <span class="token operator">AND</span> g0<span class="token punctuation">.</span>GeographyCode <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token keyword">then</span> g0<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> gdi1<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'Country'</span> <span class="token operator">AND</span> g1<span class="token punctuation">.</span>GeographyCode <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token keyword">then</span> g1<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> gdi2<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'Country'</span> <span class="token operator">AND</span> g2<span class="token punctuation">.</span>GeographyCode <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token keyword">then</span> g2<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> gdi3<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'Country'</span> <span class="token operator">AND</span> g3<span class="token punctuation">.</span>GeographyCode <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token keyword">then</span> g3<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> gdi4<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'Country'</span> <span class="token operator">AND</span> g4<span class="token punctuation">.</span>GeographyCode <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token keyword">then</span> g4<span class="token punctuation">.</span>Name
    <span class="token keyword">else</span> <span class="token boolean">null</span>
  <span class="token keyword">end</span> <span class="token keyword">as</span> country<span class="token punctuation">,</span>

  <span class="token comment">-- countryCode</span>
  <span class="token keyword">case</span>
    <span class="token keyword">when</span> gdi0<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'Country'</span> <span class="token keyword">then</span> g0<span class="token punctuation">.</span>GeographyCode
    <span class="token keyword">when</span> gdi1<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'Country'</span> <span class="token keyword">then</span> g1<span class="token punctuation">.</span>GeographyCode
    <span class="token keyword">when</span> gdi2<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'Country'</span> <span class="token keyword">then</span> g2<span class="token punctuation">.</span>GeographyCode
    <span class="token keyword">when</span> gdi3<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'Country'</span> <span class="token keyword">then</span> g3<span class="token punctuation">.</span>GeographyCode
    <span class="token keyword">when</span> gdi4<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'Country'</span> <span class="token keyword">then</span> g4<span class="token punctuation">.</span>GeographyCode
    <span class="token keyword">else</span> <span class="token boolean">null</span>
  <span class="token keyword">end</span> <span class="token keyword">as</span> countryCode<span class="token punctuation">,</span>

  <span class="token comment">-- stateProvince</span>
  <span class="token keyword">case</span>
    <span class="token keyword">when</span> gdi0<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'State'</span> <span class="token keyword">then</span> g0<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> gdi1<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'State'</span> <span class="token keyword">then</span> g1<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> gdi2<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'State'</span> <span class="token keyword">then</span> g2<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> gdi3<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'State'</span> <span class="token keyword">then</span> g3<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> gdi4<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'State'</span> <span class="token keyword">then</span> g4<span class="token punctuation">.</span>Name
    <span class="token keyword">else</span> <span class="token boolean">null</span>
  <span class="token keyword">end</span> <span class="token keyword">as</span> stateProvince<span class="token punctuation">,</span>

  <span class="token comment">-- county</span>
  <span class="token keyword">case</span>
    <span class="token keyword">when</span> gdi0<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'County'</span> <span class="token keyword">then</span> g0<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> gdi1<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'County'</span> <span class="token keyword">then</span> g1<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> gdi2<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'County'</span> <span class="token keyword">then</span> g2<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> gdi3<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'County'</span> <span class="token keyword">then</span> g3<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> gdi4<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'County'</span> <span class="token keyword">then</span> g4<span class="token punctuation">.</span>Name
    <span class="token keyword">else</span> <span class="token boolean">null</span>
  <span class="token keyword">end</span> <span class="token keyword">as</span> county<span class="token punctuation">,</span>

  <span class="token comment">-- verbatimLocality</span>
  l<span class="token punctuation">.</span>LocalityName <span class="token keyword">as</span> verbatimLocality<span class="token punctuation">,</span>

  <span class="token comment">-- locality</span>
  l<span class="token punctuation">.</span>LocalityName <span class="token keyword">as</span> locality<span class="token punctuation">,</span>

  <span class="token comment">-- verbatimElevation</span>
  <span class="token keyword">CASE</span>
    <span class="token keyword">WHEN</span> l<span class="token punctuation">.</span>VerbatimElevation <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">THEN</span> l<span class="token punctuation">.</span>VerbatimElevation
    <span class="token keyword">ELSE</span>
      <span class="token keyword">CASE</span> l<span class="token punctuation">.</span>Text1
        <span class="token keyword">WHEN</span> <span class="token string">'ft'</span> <span class="token keyword">THEN</span>
          <span class="token keyword">CASE</span>
            <span class="token keyword">WHEN</span> l<span class="token punctuation">.</span>MaxElevation <span class="token operator">IS</span> <span class="token boolean">NULL</span>
                <span class="token keyword">THEN</span> CONCAT_WS<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">,</span> l<span class="token punctuation">.</span>MinElevation<span class="token punctuation">,</span> l<span class="token punctuation">.</span>Text1<span class="token punctuation">)</span>
            <span class="token keyword">ELSE</span> CONCAT<span class="token punctuation">(</span>l<span class="token punctuation">.</span>MinElevation<span class="token punctuation">,</span> <span class="token string">'–'</span><span class="token punctuation">,</span> l<span class="token punctuation">.</span>MaxElevation<span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">,</span> l<span class="token punctuation">.</span>Text1<span class="token punctuation">)</span>
          <span class="token keyword">END</span>
        <span class="token keyword">ELSE</span> <span class="token boolean">NULL</span>
      <span class="token keyword">END</span>
  <span class="token keyword">END</span> <span class="token keyword">as</span> verbatimElevation<span class="token punctuation">,</span>

  <span class="token comment">-- minimumElevationInMeters</span>
  <span class="token keyword">CASE</span> l<span class="token punctuation">.</span>Text1
    <span class="token keyword">WHEN</span> <span class="token string">'ft'</span> <span class="token keyword">THEN</span> <span class="token function">round</span><span class="token punctuation">(</span>l<span class="token punctuation">.</span>MinElevation <span class="token operator">*</span> <span class="token number">0.3048</span><span class="token punctuation">)</span>
    <span class="token keyword">ELSE</span> l<span class="token punctuation">.</span>MinElevation
  <span class="token keyword">END</span> <span class="token keyword">as</span> minimumElevationInMeters<span class="token punctuation">,</span>

  <span class="token comment">-- maximumElevationInMeters</span>
  <span class="token keyword">CASE</span>
    <span class="token keyword">WHEN</span> l<span class="token punctuation">.</span>MaxElevation <span class="token operator">Is</span> <span class="token boolean">Null</span> <span class="token keyword">THEN</span>
      <span class="token keyword">CASE</span> l<span class="token punctuation">.</span>Text1
        <span class="token keyword">WHEN</span> <span class="token string">'ft'</span> <span class="token keyword">THEN</span> <span class="token function">round</span><span class="token punctuation">(</span>l<span class="token punctuation">.</span>MinElevation <span class="token operator">*</span> <span class="token number">0.3048</span><span class="token punctuation">)</span>
        <span class="token keyword">ELSE</span> l<span class="token punctuation">.</span>MinElevation
      <span class="token keyword">END</span>
    <span class="token keyword">ELSE</span>
      <span class="token keyword">CASE</span> l<span class="token punctuation">.</span>Text1
        <span class="token keyword">WHEN</span> <span class="token string">'ft'</span> <span class="token keyword">THEN</span> <span class="token function">round</span><span class="token punctuation">(</span>l<span class="token punctuation">.</span>MaxElevation <span class="token operator">*</span> <span class="token number">0.3048</span><span class="token punctuation">)</span>
        <span class="token keyword">ELSE</span> l<span class="token punctuation">.</span>MaxElevation
      <span class="token keyword">END</span>
  <span class="token keyword">END</span> <span class="token keyword">as</span> maximumElevationInMeters<span class="token punctuation">,</span>

  <span class="token comment">-- verbatimDepth</span>
  <span class="token keyword">CASE</span>
    <span class="token keyword">WHEN</span> EndDepth <span class="token operator">IS</span> <span class="token boolean">NULL</span> <span class="token keyword">THEN</span>
      <span class="token keyword">CASE</span> StartDepthUnit
        <span class="token keyword">WHEN</span> <span class="token string">'2'</span> <span class="token keyword">THEN</span> CONCAT<span class="token punctuation">(</span>StartDepth<span class="token punctuation">,</span> <span class="token string">' ft'</span><span class="token punctuation">)</span>
        <span class="token keyword">WHEN</span> <span class="token string">'3'</span> <span class="token keyword">THEN</span> CONCAT<span class="token punctuation">(</span>StartDepth<span class="token punctuation">,</span> <span class="token string">' fathoms'</span><span class="token punctuation">)</span>
        <span class="token keyword">ELSE</span> <span class="token boolean">NULL</span>
      <span class="token keyword">END</span>
    <span class="token keyword">ELSE</span>
      <span class="token keyword">CASE</span> StartDepthUnit
        <span class="token keyword">WHEN</span> <span class="token string">'2'</span> <span class="token keyword">THEN</span> CONCAT<span class="token punctuation">(</span>StartDepth<span class="token punctuation">,</span> <span class="token string">'–'</span><span class="token punctuation">,</span> EndDepth<span class="token punctuation">,</span> <span class="token string">' ft'</span><span class="token punctuation">)</span>
        <span class="token keyword">WHEN</span> <span class="token string">'3'</span> <span class="token keyword">THEN</span> CONCAT<span class="token punctuation">(</span>StartDepth<span class="token punctuation">,</span> <span class="token string">'–'</span><span class="token punctuation">,</span> ENDDepth<span class="token punctuation">,</span> <span class="token string">' fathoms'</span><span class="token punctuation">)</span>
        <span class="token keyword">ELSE</span> <span class="token boolean">NULL</span>
      <span class="token keyword">END</span>
  <span class="token keyword">END</span> <span class="token keyword">as</span> verbatimDepth<span class="token punctuation">,</span>

  <span class="token comment">-- minimumDepthInMeters</span>
  <span class="token keyword">CASE</span> StartDepthUnit
    <span class="token keyword">WHEN</span> <span class="token string">'1'</span> <span class="token keyword">THEN</span> StartDepth
    <span class="token keyword">WHEN</span> <span class="token string">'2'</span> <span class="token keyword">THEN</span> <span class="token function">ROUND</span><span class="token punctuation">(</span>StartDepth <span class="token operator">*</span> <span class="token number">0.3048</span><span class="token punctuation">)</span>
    <span class="token keyword">WHEN</span> <span class="token string">'3'</span> <span class="token keyword">THEN</span> <span class="token function">ROUND</span><span class="token punctuation">(</span>StartDepth <span class="token operator">*</span> <span class="token number">1.8288</span><span class="token punctuation">)</span>
  <span class="token keyword">END</span> <span class="token keyword">as</span> minimumDepthInMeters<span class="token punctuation">,</span>

  <span class="token comment">-- maximumDepthInMeters</span>
  <span class="token keyword">CASE</span>
  <span class="token keyword">WHEN</span> EndDepth <span class="token operator">IS</span> <span class="token boolean">NULL</span> <span class="token keyword">THEN</span>
    <span class="token keyword">CASE</span> StartDepthUnit
      <span class="token keyword">WHEN</span> <span class="token string">'1'</span> <span class="token keyword">THEN</span> StartDepth
      <span class="token keyword">WHEN</span> <span class="token string">'2'</span> <span class="token keyword">THEN</span> <span class="token function">ROUND</span><span class="token punctuation">(</span>StartDepth <span class="token operator">*</span> <span class="token number">0.3048</span><span class="token punctuation">)</span>
      <span class="token keyword">WHEN</span> <span class="token string">'3'</span> <span class="token keyword">THEN</span> <span class="token function">ROUND</span><span class="token punctuation">(</span>StartDepth <span class="token operator">*</span> <span class="token number">1.8288</span><span class="token punctuation">)</span>
    <span class="token keyword">END</span>
  <span class="token keyword">ELSE</span>
    <span class="token keyword">CASE</span> StartDepthUnit
      <span class="token keyword">WHEN</span> <span class="token string">'1'</span> <span class="token keyword">THEN</span> EndDepth
      <span class="token keyword">WHEN</span> <span class="token string">'2'</span> <span class="token keyword">THEN</span> <span class="token function">ROUND</span><span class="token punctuation">(</span>EndDepth <span class="token operator">*</span> <span class="token number">0.3048</span><span class="token punctuation">)</span>
      <span class="token keyword">WHEN</span> <span class="token string">'3'</span> <span class="token keyword">THEN</span> <span class="token function">ROUND</span><span class="token punctuation">(</span>EndDepth <span class="token operator">*</span> <span class="token number">1.8288</span><span class="token punctuation">)</span>
    <span class="token keyword">END</span>
  <span class="token keyword">END</span> <span class="token keyword">as</span> maximumDepthInMeters<span class="token punctuation">,</span>

  <span class="token comment">-- verbatimLatitude</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>l<span class="token punctuation">.</span>Latitude1 <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token operator">and</span> l<span class="token punctuation">.</span>Longitude1 <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span> l<span class="token punctuation">.</span>Lat1Text<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span>
      <span class="token keyword">as</span> verbatimLatitude<span class="token punctuation">,</span>

  <span class="token comment">-- verbatimLongitude</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>l<span class="token punctuation">.</span>Latitude1 <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token operator">and</span> l<span class="token punctuation">.</span>Longitude1 <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span> l<span class="token punctuation">.</span>Long1Text<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span>
      <span class="token keyword">as</span> verbatimLongitude<span class="token punctuation">,</span>

  <span class="token comment">-- verbatimCoordinateSystem</span>
  gc<span class="token punctuation">.</span>OriginalCoordSystem <span class="token keyword">as</span> verbatimCoordinateSystem<span class="token punctuation">,</span>

  <span class="token comment">-- verbatimSRS</span>
  srs_from_datum<span class="token punctuation">(</span>l<span class="token punctuation">.</span>Datum<span class="token punctuation">)</span> <span class="token keyword">as</span> verbatimSRS<span class="token punctuation">,</span>

  <span class="token comment">-- decimalLatitude</span>
  l<span class="token punctuation">.</span>Latitude1 <span class="token keyword">as</span> decimalLatitude<span class="token punctuation">,</span>

  <span class="token comment">-- decimalLongitude</span>
  l<span class="token punctuation">.</span>Longitude1 <span class="token keyword">as</span> decimalLongitude<span class="token punctuation">,</span>

  <span class="token comment">-- geodeticDatum</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>l<span class="token punctuation">.</span>Latitude1 <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token operator">and</span> l<span class="token punctuation">.</span>Longitude1 <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>l<span class="token punctuation">.</span>Datum <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>
      srs_from_datum<span class="token punctuation">(</span>l<span class="token punctuation">.</span>Datum<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'epsg:4326'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">null</span>
    <span class="token punctuation">)</span> <span class="token keyword">as</span> geodeticDatum<span class="token punctuation">,</span>

  <span class="token comment">-- coordinateUncertaintyInMeters</span>
  <span class="token keyword">coalesce</span><span class="token punctuation">(</span><span class="token function">ROUND</span><span class="token punctuation">(</span>gc<span class="token punctuation">.</span>GeoRefAccuracy<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">ROUND</span><span class="token punctuation">(</span>gc<span class="token punctuation">.</span>MaxUncertaintyEst<span class="token punctuation">)</span><span class="token punctuation">,</span>
      coordinate_uncertainty_in_meters<span class="token punctuation">(</span>l<span class="token punctuation">.</span>OriginalElevationUnit<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">as</span> coordinateUncertaintyInMeters<span class="token punctuation">,</span>

  <span class="token comment">-- coordinatePrecision</span>
  gc<span class="token punctuation">.</span>NamedPlaceExtent <span class="token keyword">as</span> coordinatePrecision<span class="token punctuation">,</span>

  <span class="token comment">-- georeferencedBy</span>
  concat_ws<span class="token punctuation">(</span><span class="token string">', '</span><span class="token punctuation">,</span> gca<span class="token punctuation">.</span>LastName<span class="token punctuation">,</span> gca<span class="token punctuation">.</span>FirstName<span class="token punctuation">)</span> <span class="token keyword">as</span> georeferencedBy<span class="token punctuation">,</span>

  <span class="token comment">-- georeferenceDate</span>
  gc<span class="token punctuation">.</span>GeoRefDetDate <span class="token keyword">as</span> georeferencedDate<span class="token punctuation">,</span>

  <span class="token comment">-- georeferenceProtocol</span>
  l<span class="token punctuation">.</span>LatLongMethod <span class="token keyword">as</span> georeferenceProtocol<span class="token punctuation">,</span>

  <span class="token comment">-- georeferenceSources</span>
  gc<span class="token punctuation">.</span>Text1 <span class="token keyword">as</span> georeferenceSources<span class="token punctuation">,</span>

  <span class="token comment">-- georeferenceVerificationStatus</span>
  <span class="token keyword">replace</span><span class="token punctuation">(</span>gc<span class="token punctuation">.</span>GeoRefVerificationStatus<span class="token punctuation">,</span> <span class="token string">'Corrected'</span><span class="token punctuation">,</span> <span class="token string">'Verified'</span><span class="token punctuation">)</span>
      <span class="token keyword">as</span> georeferenceVerificationStatus<span class="token punctuation">,</span>

  <span class="token comment">-- georeferenceRemarks</span>
  gc<span class="token punctuation">.</span>GeoRefRemarks <span class="token keyword">as</span> georeferenceRemarks<span class="token punctuation">,</span>

  <span class="token comment">/*
  * Identification
  */</span>

  <span class="token comment">-- identificationID</span>
  d<span class="token punctuation">.</span>GUID <span class="token keyword">as</span> identificationID<span class="token punctuation">,</span>

  <span class="token comment">-- identifiedBy,</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span>FeatureOrBasis<span class="token operator">=</span><span class="token string">'Acc. name change'</span> <span class="token operator">or</span> d<span class="token punctuation">.</span>FeatureOrBasis<span class="token operator">=</span><span class="token string">'AVH annot.'</span><span class="token punctuation">,</span>
      <span class="token string">'National Herbarium of Victoria (MEL)'</span><span class="token punctuation">,</span>
      concat_ws<span class="token punctuation">(</span><span class="token string">', '</span><span class="token punctuation">,</span> da<span class="token punctuation">.</span>LastName<span class="token punctuation">,</span> da<span class="token punctuation">.</span>FirstName<span class="token punctuation">)</span>
  <span class="token punctuation">)</span> <span class="token keyword">as</span> identifiedBy<span class="token punctuation">,</span>

  <span class="token comment">-- identifiedByID</span>
  identified_by_id<span class="token punctuation">(</span>d<span class="token punctuation">.</span>DeterminationID<span class="token punctuation">)</span> <span class="token keyword">as</span> identifiedByID<span class="token punctuation">,</span>

  <span class="token comment">-- dateIdentified</span>
  dateWithPrecision<span class="token punctuation">(</span>d<span class="token punctuation">.</span>DeterminedDate<span class="token punctuation">,</span> d<span class="token punctuation">.</span>DeterminedDatePrecision<span class="token punctuation">)</span>
      <span class="token keyword">as</span> dateIdentified<span class="token punctuation">,</span>

  <span class="token comment">-- identificationRemarks</span>
  d<span class="token punctuation">.</span>Remarks <span class="token keyword">as</span> identificationRemarks<span class="token punctuation">,</span>

  <span class="token comment">-- identificationQualifier</span>
  dwc_identification_qualifier<span class="token punctuation">(</span>d<span class="token punctuation">.</span>Qualifier<span class="token punctuation">,</span> d<span class="token punctuation">.</span>VarQualifier<span class="token punctuation">,</span> t0<span class="token punctuation">.</span>TaxonID<span class="token punctuation">)</span>
      <span class="token keyword">as</span> identificationQualifier<span class="token punctuation">,</span>

  <span class="token comment">-- typeStatus</span>
  dwc_type_status<span class="token punctuation">(</span>co<span class="token punctuation">.</span>CollectionObjectID<span class="token punctuation">)</span> <span class="token keyword">as</span> typeStatus<span class="token punctuation">,</span>

  <span class="token comment">/*
  * Taxon
  */</span>

  <span class="token comment">-- scientificName</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>t0<span class="token punctuation">.</span>FullName <span class="token operator">LIKE</span> <span class="token string">'% [%'</span> <span class="token punctuation">,</span>
      substring<span class="token punctuation">(</span>t0<span class="token punctuation">.</span>FullName<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> LOCATE<span class="token punctuation">(</span><span class="token string">' ['</span><span class="token punctuation">,</span> t0<span class="token punctuation">.</span>FullName<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      t0<span class="token punctuation">.</span>FullName
  <span class="token punctuation">)</span> <span class="token keyword">as</span> scientificName<span class="token punctuation">,</span>

  <span class="token comment">-- scientificNameAuthorship</span>
  t0<span class="token punctuation">.</span>Author <span class="token keyword">as</span> scientificNameAuthorship<span class="token punctuation">,</span>

  <span class="token comment">-- higherClassification</span>
  <span class="token keyword">case</span>
    <span class="token keyword">when</span> t12<span class="token punctuation">.</span>TaxonID <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token operator">and</span> tdi12<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'life'</span> <span class="token keyword">then</span> concat_ws<span class="token punctuation">(</span><span class="token string">' | '</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t12<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t12<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t11<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t11<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t10<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t10<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t9<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t9<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t8<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t8<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t7<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t7<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t6<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t6<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t5<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t5<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t4<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t4<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t3<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t3<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t2<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t1<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t1<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span>
    <span class="token keyword">when</span> t11<span class="token punctuation">.</span>TaxonID <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token operator">and</span> tdi11<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'life'</span> <span class="token keyword">then</span> concat_ws<span class="token punctuation">(</span><span class="token string">' | '</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t11<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t11<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t10<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t10<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t9<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t9<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t8<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t8<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t7<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t7<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t6<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t6<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t5<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t5<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t4<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t4<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t3<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t3<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t2<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t1<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t1<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span>
    <span class="token keyword">when</span> t10<span class="token punctuation">.</span>TaxonID <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token operator">and</span> tdi10<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'life'</span> <span class="token keyword">then</span> concat_ws<span class="token punctuation">(</span><span class="token string">' | '</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t10<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t10<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t9<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t9<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t8<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t8<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t7<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t7<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t6<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t6<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t5<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t5<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t4<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t4<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t3<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t3<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t2<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t1<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t1<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span>
    <span class="token keyword">when</span> t9<span class="token punctuation">.</span>TaxonID <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token operator">and</span> tdi9<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'life'</span> <span class="token keyword">then</span> concat_ws<span class="token punctuation">(</span><span class="token string">' | '</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t9<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t9<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t8<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t8<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t7<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t7<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t6<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t6<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t5<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t5<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t4<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t4<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t3<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t3<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t2<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t1<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t1<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span>
    <span class="token keyword">when</span> t8<span class="token punctuation">.</span>TaxonID <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token operator">and</span> tdi8<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'life'</span> <span class="token keyword">then</span> concat_ws<span class="token punctuation">(</span><span class="token string">' | '</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t8<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t8<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t7<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t7<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t6<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t6<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t5<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t5<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t4<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t4<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t3<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t3<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t2<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t1<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t1<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span>
    <span class="token keyword">when</span> t7<span class="token punctuation">.</span>TaxonID <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token operator">and</span> tdi7<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'life'</span> <span class="token keyword">then</span> concat_ws<span class="token punctuation">(</span><span class="token string">' | '</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t7<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t7<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t6<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t6<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t5<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t5<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t4<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t4<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t3<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t3<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t2<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>t1<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t1<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span>
    <span class="token keyword">when</span> t6<span class="token punctuation">.</span>TaxonID <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token operator">and</span> tdi6<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'life'</span> <span class="token keyword">then</span> concat_ws<span class="token punctuation">(</span><span class="token string">' | '</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t6<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t6<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t5<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t5<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t4<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t4<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t3<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t3<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t2<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t1<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t1<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span>
    <span class="token keyword">when</span> t5<span class="token punctuation">.</span>TaxonID <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token operator">and</span> tdi5<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'life'</span> <span class="token keyword">then</span> concat_ws<span class="token punctuation">(</span><span class="token string">' | '</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t4<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t4<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t3<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t3<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t2<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t1<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t1<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span>
    <span class="token keyword">when</span> t4<span class="token punctuation">.</span>TaxonID <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token operator">and</span> tdi4<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'life'</span> <span class="token keyword">then</span> concat_ws<span class="token punctuation">(</span><span class="token string">' | '</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t4<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t4<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t3<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t3<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t2<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t1<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t1<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span>
    <span class="token keyword">when</span> t3<span class="token punctuation">.</span>TaxonID <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token operator">and</span> tdi3<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'life'</span> <span class="token keyword">then</span> concat_ws<span class="token punctuation">(</span><span class="token string">' | '</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t3<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t3<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t2<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t1<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t1<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span>
    <span class="token keyword">when</span> t2<span class="token punctuation">.</span>TaxonID <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token operator">and</span> tdi2<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'life'</span> <span class="token keyword">then</span> concat_ws<span class="token punctuation">(</span><span class="token string">' | '</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t2<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t1<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t1<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span>
    <span class="token keyword">when</span> t1<span class="token punctuation">.</span>TaxonID <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token operator">and</span> tdi1<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'life'</span> <span class="token keyword">then</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t1<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span><span class="token punctuation">,</span> t1<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span> <span class="token boolean">null</span>
  <span class="token keyword">end</span> <span class="token keyword">as</span> higherClassification<span class="token punctuation">,</span>

  <span class="token comment">-- kingdom</span>
  <span class="token keyword">case</span>
    <span class="token keyword">when</span> tdi0<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'kingdom'</span> <span class="token operator">and</span> t0<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t0<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi1<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'kingdom'</span> <span class="token operator">and</span> t1<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t1<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi2<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'kingdom'</span> <span class="token operator">and</span> t2<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t2<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi3<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'kingdom'</span> <span class="token operator">and</span> t3<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t3<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi4<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'kingdom'</span> <span class="token operator">and</span> t4<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t4<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi5<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'kingdom'</span> <span class="token operator">and</span> t5<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t5<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi6<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'kingdom'</span> <span class="token operator">and</span> t6<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t6<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi7<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'kingdom'</span> <span class="token operator">and</span> t7<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t7<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi8<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'kingdom'</span> <span class="token operator">and</span> t8<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t8<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi9<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'kingdom'</span> <span class="token operator">and</span> t9<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t9<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi10<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'kingdom'</span> <span class="token operator">and</span> t10<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t10<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi11<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'kingdom'</span> <span class="token operator">and</span> t11<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t11<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi12<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'kingdom'</span> <span class="token operator">and</span> t12<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t12<span class="token punctuation">.</span>Name
    <span class="token keyword">else</span> <span class="token boolean">null</span>
  <span class="token keyword">end</span> <span class="token keyword">as</span> kingdom<span class="token punctuation">,</span>

  <span class="token comment">-- phylum</span>
  <span class="token keyword">case</span>
    <span class="token keyword">when</span> tdi0<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'division'</span> <span class="token operator">and</span> t0<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t0<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi1<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'division'</span> <span class="token operator">and</span> t1<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t1<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi2<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'division'</span> <span class="token operator">and</span> t2<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t2<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi3<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'division'</span> <span class="token operator">and</span> t3<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t3<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi4<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'division'</span> <span class="token operator">and</span> t4<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t4<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi5<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'division'</span> <span class="token operator">and</span> t5<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t5<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi6<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'division'</span> <span class="token operator">and</span> t6<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t6<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi7<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'division'</span> <span class="token operator">and</span> t7<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t7<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi8<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'division'</span> <span class="token operator">and</span> t8<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t8<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi9<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'division'</span> <span class="token operator">and</span> t9<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t9<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi10<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'division'</span> <span class="token operator">and</span> t10<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t10<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi11<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'division'</span> <span class="token operator">and</span> t11<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t11<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi12<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'division'</span> <span class="token operator">and</span> t12<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t12<span class="token punctuation">.</span>Name
    <span class="token keyword">else</span> <span class="token boolean">null</span>
  <span class="token keyword">end</span> <span class="token keyword">as</span> phylum<span class="token punctuation">,</span>

  <span class="token comment">-- class</span>
  <span class="token keyword">case</span>
    <span class="token keyword">when</span> tdi0<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'class'</span> <span class="token operator">and</span> t0<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t0<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi1<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'class'</span> <span class="token operator">and</span> t1<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t1<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi2<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'class'</span> <span class="token operator">and</span> t2<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t2<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi3<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'class'</span> <span class="token operator">and</span> t3<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t3<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi4<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'class'</span> <span class="token operator">and</span> t4<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t4<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi5<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'class'</span> <span class="token operator">and</span> t5<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t5<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi6<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'class'</span> <span class="token operator">and</span> t6<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t6<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi7<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'class'</span> <span class="token operator">and</span> t7<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t7<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi8<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'class'</span> <span class="token operator">and</span> t8<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t8<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi9<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'class'</span> <span class="token operator">and</span> t9<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t9<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi10<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'class'</span> <span class="token operator">and</span> t10<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t10<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi11<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'class'</span> <span class="token operator">and</span> t11<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t11<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi12<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'class'</span> <span class="token operator">and</span> t12<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t12<span class="token punctuation">.</span>Name
    <span class="token keyword">else</span> <span class="token boolean">null</span>
  <span class="token keyword">end</span> <span class="token keyword">as</span> <span class="token punctuation">`</span>class<span class="token punctuation">`</span><span class="token punctuation">,</span>

  <span class="token comment">-- order</span>
  <span class="token keyword">case</span>
    <span class="token keyword">when</span> tdi0<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'order'</span> <span class="token operator">and</span> t0<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t0<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi1<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'order'</span> <span class="token operator">and</span> t1<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t1<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi2<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'order'</span> <span class="token operator">and</span> t2<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t2<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi3<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'order'</span> <span class="token operator">and</span> t3<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t3<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi4<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'order'</span> <span class="token operator">and</span> t4<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t4<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi5<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'order'</span> <span class="token operator">and</span> t5<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t5<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi6<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'order'</span> <span class="token operator">and</span> t6<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t6<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi7<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'order'</span> <span class="token operator">and</span> t7<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t7<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi8<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'order'</span> <span class="token operator">and</span> t8<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t8<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi9<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'order'</span> <span class="token operator">and</span> t9<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t9<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi10<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'order'</span> <span class="token operator">and</span> t10<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t10<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi11<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'order'</span> <span class="token operator">and</span> t11<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t11<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi12<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'order'</span> <span class="token operator">and</span> t12<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t12<span class="token punctuation">.</span>Name
    <span class="token keyword">else</span> <span class="token boolean">null</span>
  <span class="token keyword">end</span> <span class="token keyword">as</span> <span class="token punctuation">`</span><span class="token keyword">order</span><span class="token punctuation">`</span><span class="token punctuation">,</span>

  <span class="token comment">-- family</span>
  <span class="token keyword">case</span>
    <span class="token keyword">when</span> tdi0<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'family'</span> <span class="token operator">and</span> t0<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t0<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi1<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'family'</span> <span class="token operator">and</span> t1<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t1<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi2<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'family'</span> <span class="token operator">and</span> t2<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t2<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi3<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'family'</span> <span class="token operator">and</span> t3<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t3<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi4<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'family'</span> <span class="token operator">and</span> t4<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t4<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi5<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'family'</span> <span class="token operator">and</span> t5<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t5<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi6<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'family'</span> <span class="token operator">and</span> t6<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t6<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi7<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'family'</span> <span class="token operator">and</span> t7<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t7<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi8<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'family'</span> <span class="token operator">and</span> t8<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t8<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi9<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'family'</span> <span class="token operator">and</span> t9<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t9<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi10<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'family'</span> <span class="token operator">and</span> t10<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t10<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi11<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'family'</span> <span class="token operator">and</span> t11<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t11<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi12<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'family'</span> <span class="token operator">and</span> t12<span class="token punctuation">.</span>Name<span class="token operator">!=</span><span class="token string">'Incertae sedis'</span> <span class="token keyword">then</span> t12<span class="token punctuation">.</span>Name
    <span class="token keyword">else</span> <span class="token boolean">null</span>
  <span class="token keyword">end</span> <span class="token keyword">as</span> family<span class="token punctuation">,</span>

  <span class="token comment">-- genus</span>
  <span class="token keyword">case</span>
    <span class="token keyword">when</span> tdi0<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'genus'</span> <span class="token keyword">then</span> t0<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi1<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'genus'</span> <span class="token keyword">then</span> t1<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi2<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'genus'</span> <span class="token keyword">then</span> t2<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi3<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'genus'</span> <span class="token keyword">then</span> t3<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi4<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'genus'</span> <span class="token keyword">then</span> t4<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi5<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'genus'</span> <span class="token keyword">then</span> t5<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi6<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'genus'</span> <span class="token keyword">then</span> t6<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi7<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'genus'</span> <span class="token keyword">then</span> t7<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi8<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'genus'</span> <span class="token keyword">then</span> t8<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi9<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'genus'</span> <span class="token keyword">then</span> t9<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi10<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'genus'</span> <span class="token keyword">then</span> t10<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi11<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'genus'</span> <span class="token keyword">then</span> t11<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi12<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'genus'</span> <span class="token keyword">then</span> t12<span class="token punctuation">.</span>Name
    <span class="token keyword">else</span> <span class="token boolean">null</span>
  <span class="token keyword">end</span> <span class="token keyword">as</span> genus<span class="token punctuation">,</span>

  <span class="token comment">-- specificEpithet</span>
  <span class="token keyword">case</span>
    <span class="token keyword">when</span> tdi0<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'species'</span> <span class="token keyword">then</span> t0<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi1<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'species'</span> <span class="token keyword">then</span> t1<span class="token punctuation">.</span>Name
    <span class="token keyword">when</span> tdi2<span class="token punctuation">.</span>Name<span class="token operator">=</span><span class="token string">'species'</span> <span class="token keyword">then</span> t2<span class="token punctuation">.</span>Name
    <span class="token keyword">else</span> <span class="token boolean">null</span>
  <span class="token keyword">end</span> <span class="token keyword">as</span> specificEpithet<span class="token punctuation">,</span>

  <span class="token comment">-- infraspecificEpithet</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>tdi0<span class="token punctuation">.</span>RankID<span class="token operator">&gt;</span><span class="token number">220</span><span class="token punctuation">,</span> t0<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span> <span class="token keyword">as</span> infraspecificEpithet<span class="token punctuation">,</span>

  <span class="token comment">-- taxonRank</span>
  <span class="token keyword">replace</span><span class="token punctuation">(</span>tdi0<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token string">'division'</span><span class="token punctuation">,</span> <span class="token string">'phylum'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> taxonRank<span class="token punctuation">,</span>

  <span class="token comment">-- taxonRemarks</span>
  t0<span class="token punctuation">.</span>Remarks <span class="token keyword">as</span> taxonRemarks<span class="token punctuation">,</span>

  <span class="token comment">-- nomenclaturalCode</span>
  <span class="token string">'ICN'</span> <span class="token keyword">as</span> nomenclaturalCode<span class="token punctuation">,</span>

  <span class="token comment">-- nomenclaturalStatus</span>
  t0<span class="token punctuation">.</span>EsaStatus <span class="token keyword">as</span> nomenclaturalStatus

<span class="token keyword">from</span> collectionobject co
<span class="token keyword">left</span> <span class="token keyword">join</span> collectionobjectattribute coa
  <span class="token keyword">on</span> co<span class="token punctuation">.</span>CollectionObjectAttributeID<span class="token operator">=</span>coa<span class="token punctuation">.</span>CollectionObjectAttributeID
<span class="token keyword">join</span> collectingevent ce <span class="token keyword">on</span> co<span class="token punctuation">.</span>CollectingEventID<span class="token operator">=</span>ce<span class="token punctuation">.</span>CollectingEventID
<span class="token keyword">left</span> <span class="token keyword">join</span> collectingtrip ctr <span class="token keyword">ON</span> ce<span class="token punctuation">.</span>CollectingTripID<span class="token operator">=</span>ctr<span class="token punctuation">.</span>CollectingTripID
<span class="token keyword">join</span> locality l <span class="token keyword">on</span> ce<span class="token punctuation">.</span>LocalityID<span class="token operator">=</span>l<span class="token punctuation">.</span>LocalityID

<span class="token keyword">left</span> <span class="token keyword">join</span> geography g0 <span class="token keyword">on</span> l<span class="token punctuation">.</span>GeographyID<span class="token operator">=</span>g0<span class="token punctuation">.</span>GeographyID
<span class="token keyword">left</span> <span class="token keyword">join</span> geographytreedefitem gdi0
  <span class="token keyword">on</span> g0<span class="token punctuation">.</span>GeographyTreeDefItemID<span class="token operator">=</span>gdi0<span class="token punctuation">.</span>GeographyTreeDefItemID
<span class="token keyword">left</span> <span class="token keyword">join</span> geography g1 <span class="token keyword">on</span> g0<span class="token punctuation">.</span>ParentID<span class="token operator">=</span>g1<span class="token punctuation">.</span>GeographyID
<span class="token keyword">left</span> <span class="token keyword">join</span> geographytreedefitem gdi1
  <span class="token keyword">on</span> g1<span class="token punctuation">.</span>GeographyTreeDefItemID<span class="token operator">=</span>gdi1<span class="token punctuation">.</span>GeographyTreeDefItemID
<span class="token keyword">left</span> <span class="token keyword">join</span> geography g2 <span class="token keyword">on</span> g1<span class="token punctuation">.</span>ParentID<span class="token operator">=</span>g2<span class="token punctuation">.</span>GeographyID
<span class="token keyword">left</span> <span class="token keyword">join</span> geographytreedefitem gdi2
  <span class="token keyword">on</span> g2<span class="token punctuation">.</span>GeographyTreeDefItemID<span class="token operator">=</span>gdi2<span class="token punctuation">.</span>GeographyTreeDefItemID
<span class="token keyword">left</span> <span class="token keyword">join</span> geography g3 <span class="token keyword">on</span> g2<span class="token punctuation">.</span>ParentID<span class="token operator">=</span>g3<span class="token punctuation">.</span>GeographyID
<span class="token keyword">left</span> <span class="token keyword">join</span> geographytreedefitem gdi3
  <span class="token keyword">on</span> g3<span class="token punctuation">.</span>GeographyTreeDefItemID<span class="token operator">=</span>gdi3<span class="token punctuation">.</span>GeographyTreeDefItemID
<span class="token keyword">left</span> <span class="token keyword">join</span> geography g4 <span class="token keyword">on</span> g3<span class="token punctuation">.</span>ParentID<span class="token operator">=</span>g4<span class="token punctuation">.</span>GeographyID
<span class="token keyword">left</span> <span class="token keyword">join</span> geographytreedefitem gdi4
  <span class="token keyword">on</span> g4<span class="token punctuation">.</span>GeographyTreeDefItemID<span class="token operator">=</span>gdi4<span class="token punctuation">.</span>GeographyTreeDefItemID

<span class="token keyword">left</span> <span class="token keyword">join</span> localitydetail ld <span class="token keyword">on</span> l<span class="token punctuation">.</span>LocalityID<span class="token operator">=</span>ld<span class="token punctuation">.</span>LocalityID
<span class="token keyword">left</span> <span class="token keyword">join</span> geocoorddetail gc <span class="token keyword">on</span> l<span class="token punctuation">.</span>LocalityID<span class="token operator">=</span>gc<span class="token punctuation">.</span>LocalityID
<span class="token keyword">left</span> <span class="token keyword">join</span> agent gca <span class="token keyword">on</span> gc<span class="token punctuation">.</span>AgentID<span class="token operator">=</span>gca<span class="token punctuation">.</span>AgentID
<span class="token keyword">left</span> <span class="token keyword">join</span> determination d <span class="token keyword">on</span> co<span class="token punctuation">.</span>CollectionObjectID<span class="token operator">=</span>d<span class="token punctuation">.</span>CollectionObjectID <span class="token operator">and</span> d<span class="token punctuation">.</span>IsCurrent<span class="token operator">=</span><span class="token boolean">true</span>
<span class="token keyword">left</span> <span class="token keyword">join</span> agent da <span class="token keyword">on</span> d<span class="token punctuation">.</span>DeterminerID<span class="token operator">=</span>da<span class="token punctuation">.</span>AgentID

<span class="token keyword">left</span> <span class="token keyword">join</span> taxon t0 <span class="token keyword">on</span> d<span class="token punctuation">.</span>TaxonID<span class="token operator">=</span>t0<span class="token punctuation">.</span>TaxonID
<span class="token keyword">left</span> <span class="token keyword">join</span> taxontreedefitem tdi0 <span class="token keyword">on</span> t0<span class="token punctuation">.</span>TaxonTreeDefItemID<span class="token operator">=</span>tdi0<span class="token punctuation">.</span>TaxonTreeDefItemID
<span class="token keyword">left</span> <span class="token keyword">join</span> taxon t1 <span class="token keyword">on</span> t0<span class="token punctuation">.</span>ParentID<span class="token operator">=</span>t1<span class="token punctuation">.</span>TaxonID
<span class="token keyword">left</span> <span class="token keyword">join</span> taxontreedefitem tdi1 <span class="token keyword">on</span> t1<span class="token punctuation">.</span>TaxonTreeDefItemID<span class="token operator">=</span>tdi1<span class="token punctuation">.</span>TaxonTreeDefItemID
<span class="token keyword">left</span> <span class="token keyword">join</span> taxon t2 <span class="token keyword">on</span> t1<span class="token punctuation">.</span>ParentID<span class="token operator">=</span>t2<span class="token punctuation">.</span>TaxonID
<span class="token keyword">left</span> <span class="token keyword">join</span> taxontreedefitem tdi2 <span class="token keyword">on</span> t2<span class="token punctuation">.</span>TaxonTreeDefItemID<span class="token operator">=</span>tdi2<span class="token punctuation">.</span>TaxonTreeDefItemID
<span class="token keyword">left</span> <span class="token keyword">join</span> taxon t3 <span class="token keyword">on</span> t2<span class="token punctuation">.</span>ParentID<span class="token operator">=</span>t3<span class="token punctuation">.</span>TaxonID
<span class="token keyword">left</span> <span class="token keyword">join</span> taxontreedefitem tdi3 <span class="token keyword">on</span> t3<span class="token punctuation">.</span>TaxonTreeDefItemID<span class="token operator">=</span>tdi3<span class="token punctuation">.</span>TaxonTreeDefItemID
<span class="token keyword">left</span> <span class="token keyword">join</span> taxon t4 <span class="token keyword">on</span> t3<span class="token punctuation">.</span>ParentID<span class="token operator">=</span>t4<span class="token punctuation">.</span>TaxonID
<span class="token keyword">left</span> <span class="token keyword">join</span> taxontreedefitem tdi4 <span class="token keyword">on</span> t4<span class="token punctuation">.</span>TaxonTreeDefItemID<span class="token operator">=</span>tdi4<span class="token punctuation">.</span>TaxonTreeDefItemID
<span class="token keyword">left</span> <span class="token keyword">join</span> taxon t5 <span class="token keyword">on</span> t4<span class="token punctuation">.</span>ParentID<span class="token operator">=</span>t5<span class="token punctuation">.</span>TaxonID
<span class="token keyword">left</span> <span class="token keyword">join</span> taxontreedefitem tdi5 <span class="token keyword">on</span> t5<span class="token punctuation">.</span>TaxonTreeDefItemID<span class="token operator">=</span>tdi5<span class="token punctuation">.</span>TaxonTreeDefItemID
<span class="token keyword">left</span> <span class="token keyword">join</span> taxon t6 <span class="token keyword">on</span> t5<span class="token punctuation">.</span>ParentID<span class="token operator">=</span>t6<span class="token punctuation">.</span>TaxonID
<span class="token keyword">left</span> <span class="token keyword">join</span> taxontreedefitem tdi6 <span class="token keyword">on</span> t6<span class="token punctuation">.</span>TaxonTreeDefItemID<span class="token operator">=</span>tdi6<span class="token punctuation">.</span>TaxonTreeDefItemID
<span class="token keyword">left</span> <span class="token keyword">join</span> taxon t7 <span class="token keyword">on</span> t6<span class="token punctuation">.</span>ParentID<span class="token operator">=</span>t7<span class="token punctuation">.</span>TaxonID
<span class="token keyword">left</span> <span class="token keyword">join</span> taxontreedefitem tdi7 <span class="token keyword">on</span> t7<span class="token punctuation">.</span>TaxonTreeDefItemID<span class="token operator">=</span>tdi7<span class="token punctuation">.</span>TaxonTreeDefItemID
<span class="token keyword">left</span> <span class="token keyword">join</span> taxon t8 <span class="token keyword">on</span> t7<span class="token punctuation">.</span>ParentID<span class="token operator">=</span>t8<span class="token punctuation">.</span>TaxonID
<span class="token keyword">left</span> <span class="token keyword">join</span> taxontreedefitem tdi8 <span class="token keyword">on</span> t8<span class="token punctuation">.</span>TaxonTreeDefItemID<span class="token operator">=</span>tdi8<span class="token punctuation">.</span>TaxonTreeDefItemID
<span class="token keyword">left</span> <span class="token keyword">join</span> taxon t9 <span class="token keyword">on</span> t8<span class="token punctuation">.</span>ParentID<span class="token operator">=</span>t9<span class="token punctuation">.</span>TaxonID
<span class="token keyword">left</span> <span class="token keyword">join</span> taxontreedefitem tdi9 <span class="token keyword">on</span> t9<span class="token punctuation">.</span>TaxonTreeDefItemID<span class="token operator">=</span>tdi9<span class="token punctuation">.</span>TaxonTreeDefItemID
<span class="token keyword">left</span> <span class="token keyword">join</span> taxon t10 <span class="token keyword">on</span> t9<span class="token punctuation">.</span>ParentID<span class="token operator">=</span>t10<span class="token punctuation">.</span>TaxonID
<span class="token keyword">left</span> <span class="token keyword">join</span> taxontreedefitem tdi10
  <span class="token keyword">on</span> t10<span class="token punctuation">.</span>TaxonTreeDefItemID<span class="token operator">=</span>tdi10<span class="token punctuation">.</span>TaxonTreeDefItemID
<span class="token keyword">left</span> <span class="token keyword">join</span> taxon t11 <span class="token keyword">on</span> t10<span class="token punctuation">.</span>ParentID<span class="token operator">=</span>t11<span class="token punctuation">.</span>TaxonID
<span class="token keyword">left</span> <span class="token keyword">join</span> taxontreedefitem tdi11
  <span class="token keyword">on</span> t11<span class="token punctuation">.</span>TaxonTreeDefItemID<span class="token operator">=</span>tdi11<span class="token punctuation">.</span>TaxonTreeDefItemID
<span class="token keyword">left</span> <span class="token keyword">join</span> taxon t12 <span class="token keyword">on</span> t11<span class="token punctuation">.</span>ParentID<span class="token operator">=</span>t12<span class="token punctuation">.</span>TaxonID
<span class="token keyword">left</span> <span class="token keyword">join</span> taxontreedefitem tdi12
  <span class="token keyword">on</span> t12<span class="token punctuation">.</span>TaxonTreeDefItemID<span class="token operator">=</span>tdi12<span class="token punctuation">.</span>TaxonTreeDefItemID

<span class="token keyword">left</span> <span class="token keyword">join</span> mel_avh_associated_sequences seq
  <span class="token keyword">on</span> co<span class="token punctuation">.</span>CollectionObjectID<span class="token operator">=</span>seq<span class="token punctuation">.</span>CollectionObjectID
<span class="token keyword">where</span> co<span class="token punctuation">.</span>CollectionID<span class="token operator">=</span><span class="token number">4</span>
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">10/12/2021, 1:54:28 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/melisr-docs-vuepress/additional-documents/qa-tests/" class="prev">
          Quality assurance tests
        </a></span> <!----></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/melisr-docs-vuepress/assets/js/app.ed396d9f.js" defer></script><script src="/melisr-docs-vuepress/assets/js/3.08a0837d.js" defer></script><script src="/melisr-docs-vuepress/assets/js/31.d48320b5.js" defer></script>
  </body>
</html>
